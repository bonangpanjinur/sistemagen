(()=>{"use strict";const e=window.React,a=window.wp.element,t=e=>{if(!e)return"";try{const a=new Date(e);return isNaN(a.getTime())?"":a.toISOString().split("T")[0]}catch(e){return""}},l=e=>null==e?"Rp 0":new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0}).format(e),n=({label:a,type:t="text",name:l,value:n,onChange:r,required:s=!1,...m})=>(0,e.createElement)("div",{className:"mb-4"},(0,e.createElement)("label",{className:"block text-sm font-medium text-gray-700 mb-1",htmlFor:l},a," ",s&&(0,e.createElement)("span",{className:"text-red-500"},"*")),(0,e.createElement)("input",{type:t,id:l,name:l,value:n||"",onChange:r,required:s,className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500",...m})),r=({label:a,name:t,value:l,onChange:n,...r})=>(0,e.createElement)("div",{className:"mb-4"},(0,e.createElement)("label",{className:"block text-sm font-medium text-gray-700 mb-1",htmlFor:t},a),(0,e.createElement)("textarea",{id:t,name:t,value:l||"",onChange:n,rows:"3",className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500",...r})),s=({label:a,name:t,value:l,onChange:n,children:r,required:s=!1,...m})=>(0,e.createElement)("div",{className:"mb-4"},(0,e.createElement)("label",{className:"block text-sm font-medium text-gray-700 mb-1",htmlFor:t},a," ",s&&(0,e.createElement)("span",{className:"text-red-500"},"*")),(0,e.createElement)("select",{id:t,name:t,value:l||"",onChange:n,required:s,className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 bg-white",...m},r)),m=({show:a,onClose:t,title:l,children:n,footer:r})=>a?(0,e.createElement)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50 transition-opacity duration-300"},(0,e.createElement)("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-2xl max-h-[90vh] flex flex-col transition-transform duration-300 transform scale-95 opacity-0 animate-modal-in"},(0,e.createElement)("div",{className:"flex justify-between items-center p-5 border-b"},(0,e.createElement)("h3",{className:"text-lg font-semibold text-gray-800"},l),(0,e.createElement)("button",{onClick:t,className:"text-gray-400 hover:text-gray-600 transition-colors"},(0,e.createElement)("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},(0,e.createElement)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12"})))),(0,e.createElement)("div",{className:"p-6 overflow-y-auto"},n),(0,e.createElement)("div",{className:"flex justify-end items-center p-5 border-t bg-gray-50 rounded-b-lg"},r))):null,o=({onClick:a,children:t,variant:l="primary",type:n="button",...r})=>(0,e.createElement)("button",{type:n,onClick:a,className:`px-4 py-2 rounded-md font-medium transition-all duration-150 focus:outline-none focus:ring-2 focus:ring-offset-2 ${{primary:"bg-blue-600 text-white hover:bg-blue-700 focus:ring-blue-500",secondary:"bg-gray-200 text-gray-800 hover:bg-gray-300 focus:ring-gray-400",danger:"bg-red-600 text-white hover:bg-red-700 focus:ring-red-500",outline:"bg-white text-gray-700 border border-gray-300 hover:bg-gray-50 focus:ring-blue-500"}[l]}`,...r},t),i=()=>(0,e.createElement)("div",{className:"flex justify-center items-center h-64"},(0,e.createElement)("div",{className:"animate-spin rounded-full h-16 w-16 border-t-4 border-b-4 border-blue-600"})),c=({message:a,type:t="error"})=>a?(0,e.createElement)("div",{className:`border px-4 py-3 rounded-md my-4 ${{error:"bg-red-100 border-red-400 text-red-700",success:"bg-green-100 border-green-400 text-green-700"}[t]}`,role:"alert"},(0,e.createElement)("span",{className:"block sm:inline"},a)):null,d=window.umh_wp_data||{api_url:"/wp-json/umh/v1/",nonce:"",user:{token:""}},u={getToken:()=>d.user?d.user.token:null,request:async(e,a="GET",t=null)=>{const l={method:a,headers:{"Content-Type":"application/json",Authorization:`Bearer ${u.getToken()}`}};t&&(l.body=JSON.stringify(t));try{const a=await fetch(d.api_url+e,l);if(204===a.status)return{success:!0};const t=await a.json();if(!a.ok)throw new Error(t.message||`Error ${a.status}: ${a.statusText}`);return t}catch(t){throw console.error(`API Error (${a} ${e}):`,t),t}},get:e=>u.request(e,"GET"),post:(e,a)=>u.request(e,"POST",a),put:(e,a)=>u.request(e,"PUT",a),del:e=>u.request(e,"DELETE")},p=(a,t,l)=>{const[n,r]=(0,e.useState)([]),[s,m]=(0,e.useState)({}),[o,i]=(0,e.useState)(!0),[c,d]=(0,e.useState)(null),[p,g]=(0,e.useState)(!1),[h,b]=(0,e.useState)(!1),[y,E]=(0,e.useState)(null),[f,k]=(0,e.useState)(t),[v,x]=(0,e.useState)(null),_=e=>{x(e),setTimeout(()=>x(null),3e3)},w=(0,e.useCallback)(async()=>{if(l)try{const e=await l();m(e||{})}catch(e){d(`Gagal memuat data pendukung: ${e.message}`)}},[l]),N=(0,e.useCallback)(async()=>{i(!0),d(null);try{await w();const e=await u.get(a);r(e)}catch(e){d(`Gagal memuat data ${a}: ${e.message}`)}finally{i(!1)}},[a,w]);(0,e.useEffect)(()=>{N()},[N]);const C=()=>{g(!1),d(null)};return{list:n,dependencies:s,isLoading:o,error:c,successMessage:v,isModalOpen:p,isEditing:h,currentItem:y,formState:f,handleChange:e=>{const{name:a,value:t,type:l,checked:n}=e.target;k(e=>({...e,[a]:"checkbox"===l?n:t}))},handleAddNew:()=>{b(!1),E(null),k(t),g(!0)},handleEdit:e=>{b(!0),E(e),k(e),g(!0)},handleCloseModal:C,handleSubmit:async e=>{e.preventDefault(),d(null);try{let e;h?(e=await u.put(`${a}/${y.id}`,f),_("Data berhasil diperbarui.")):(e=await u.post(a,f),_("Data berhasil ditambahkan.")),N(),C()}catch(e){d(`Gagal menyimpan: ${e.message}`)}},handleDelete:async e=>{if(window.confirm("Apakah Anda yakin ingin menghapus data ini?")){d(null);try{await u.del(`${a}/${e}`),_("Data berhasil dihapus."),N()}catch(e){d(`Gagal menghapus: ${e.message}`)}}},fetchData:N,setError:d,setFormState:k,fetchDependencies:w}},g=({columns:a,data:t,onEdit:l,onDelete:n})=>(0,e.createElement)("div",{className:"overflow-x-auto shadow-md rounded-lg"},(0,e.createElement)("table",{className:"min-w-full divide-y divide-gray-200"},(0,e.createElement)("thead",{className:"bg-gray-100"},(0,e.createElement)("tr",null,a.map(a=>(0,e.createElement)("th",{key:a.key,className:"px-6 py-3 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider"},a.label)),(0,e.createElement)("th",{className:"px-6 py-3 text-right text-xs font-semibold text-gray-600 uppercase tracking-wider"},"Aksi"))),(0,e.createElement)("tbody",{className:"bg-white divide-y divide-gray-200"},0===t.length?(0,e.createElement)("tr",null,(0,e.createElement)("td",{colSpan:a.length+1,className:"px-6 py-4 text-center text-gray-500"},"Tidak ada data.")):t.map(t=>(0,e.createElement)("tr",{key:t.id,className:"hover:bg-gray-50"},a.map(a=>(0,e.createElement)("td",{key:a.key,className:"px-6 py-4 whitespace-nowrap text-sm text-gray-800"},a.render?a.render(t):t[a.key])),(0,e.createElement)("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium"},(0,e.createElement)("button",{onClick:()=>l(t),className:"text-blue-600 hover:text-blue-800 mr-3"},"Edit"),(0,e.createElement)("button",{onClick:()=>n(t.id),className:"text-red-600 hover:text-red-800"},"Hapus"))))))),h=()=>{const[a,t]=(0,e.useState)(null),[n,r]=(0,e.useState)(!0),[s,m]=(0,e.useState)(null);if((0,e.useEffect)(()=>{(async()=>{try{r(!0);const e=await u.get("stats/totals");t(e)}catch(e){m(e.message)}finally{r(!1)}})()},[]),n)return(0,e.createElement)(i,null);if(s)return(0,e.createElement)(c,{message:`Gagal memuat statistik: ${s}`});const{total_jamaah:o,total_packages:d,total_revenue:p}=a||{},g=a?.total_jamaah_lunas||0;return(0,e.createElement)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6"},(0,e.createElement)(b,{title:"Total Jemaah",value:o||0}),(0,e.createElement)(b,{title:"Total Paket",value:d||0}),(0,e.createElement)(b,{title:"Total Pemasukan",value:l(p||0)}),(0,e.createElement)(b,{title:"Jemaah Lunas",value:g}))},b=({title:a,value:t})=>(0,e.createElement)("div",{className:"bg-white p-6 rounded-lg shadow-md"},(0,e.createElement)("h3",{className:"text-sm font-medium text-gray-500 uppercase"},a),(0,e.createElement)("p",{className:"mt-2 text-3xl font-semibold text-gray-900"},t)),y=()=>{const a=(0,e.useCallback)(async()=>{const[e,a,t]=await Promise.all([u.get("categories"),u.get("flights"),u.get("hotels")]);return{categories:e,flights:a,hotels:t}},[]),{list:d,dependencies:h,isLoading:b,error:y,successMessage:E,isModalOpen:f,isEditing:k,formState:v,setFormState:x,handleChange:_,handleAddNew:w,handleCloseModal:N,handleSubmit:C,handleDelete:S}=p("packages",{name:"",category_id:"",description:"",departure_date:"",duration_days:0,status:"draft",prices:[{room_type:"Quad",price:0}],flight_ids:[],hotel_bookings:[]},a),T=(e,a,t)=>{const l=[...v.prices];l[e][a]=t,x(e=>({...e,prices:l}))},D=(e,a,t)=>{const l=[...v.hotel_bookings];l[e][a]=t,x(e=>({...e,hotel_bookings:l}))},P=[{key:"name",label:"Nama Paket"},{key:"category",label:"Kategori",render:e=>h.categories?.find(a=>a.id==e.category_id)?.name||"N/A"},{key:"price",label:"Harga",render:e=>{if(!e.prices||0===e.prices.length)return"Rp 0";const a=Math.min(...e.prices.map(e=>e.price));return`Mulai dari ${l(a)}`}},{key:"departure_date",label:"Keberangkatan",render:e=>t(e.departure_date)},{key:"duration_days",label:"Durasi (Hari)"},{key:"status",label:"Status"}];return(0,e.createElement)("div",null,(0,e.createElement)("div",{className:"flex justify-between items-center mb-6"},(0,e.createElement)("h2",{className:"text-2xl font-semibold text-gray-800"},"Manajemen Paket"),(0,e.createElement)(o,{onClick:w},"Tambah Paket Baru")),(0,e.createElement)(c,{message:y,type:"error"}),(0,e.createElement)(c,{message:E,type:"success"}),b?(0,e.createElement)(i,null):(0,e.createElement)(g,{columns:P,data:d,onEdit:e=>{setIsEditing(!0),setCurrentItem(e),x({...e,prices:e.prices||[],flight_ids:e.flight_ids||[],hotel_bookings:e.hotel_bookings||[]}),setModalOpen(!0)},onDelete:S}),(0,e.createElement)(m,{show:f,onClose:N,title:k?"Edit Paket":"Tambah Paket Baru",footer:(0,e.createElement)(e.Fragment,null,(0,e.createElement)(o,{onClick:N,variant:"secondary",className:"mr-2"},"Batal"),(0,e.createElement)(o,{onClick:C,type:"submit",form:"package-form"},"Simpan"))},(0,e.createElement)("form",{id:"package-form",onSubmit:C},(0,e.createElement)(n,{label:"Nama Paket",name:"name",value:v.name,onChange:_,required:!0}),(0,e.createElement)(s,{label:"Kategori",name:"category_id",value:v.category_id,onChange:_,required:!0},(0,e.createElement)("option",{value:""},"Pilih Kategori"),h.categories?.map(a=>(0,e.createElement)("option",{key:a.id,value:a.id},a.name))),(0,e.createElement)(r,{label:"Deskripsi",name:"description",value:v.description,onChange:_}),(0,e.createElement)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4"},(0,e.createElement)(n,{label:"Tanggal Keberangkatan",name:"departure_date",type:"date",value:t(v.departure_date),onChange:_,required:!0}),(0,e.createElement)(n,{label:"Durasi (hari)",name:"duration_days",type:"number",value:v.duration_days,onChange:_,required:!0})),(0,e.createElement)(s,{label:"Status",name:"status",value:v.status,onChange:_,required:!0},(0,e.createElement)("option",{value:"draft"},"Draft"),(0,e.createElement)("option",{value:"published"},"Published"),(0,e.createElement)("option",{value:"archived"},"Archived")),(0,e.createElement)("div",{className:"p-4 border border-gray-200 rounded-md mt-6"},(0,e.createElement)("h4",{className:"font-semibold text-gray-700 mb-3"},"Harga Dinamis"),v.prices.map((a,t)=>(0,e.createElement)("div",{key:t,className:"flex items-center gap-2 mb-2"},(0,e.createElement)("input",{type:"text",placeholder:"Tipe Kamar (e.g., Quad)",value:a.room_type,onChange:e=>T(t,"room_type",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm"}),(0,e.createElement)("input",{type:"number",placeholder:"Harga",value:a.price,onChange:e=>T(t,"price",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm"}),(0,e.createElement)(o,{type:"button",variant:"danger",onClick:()=>(e=>{const a=v.prices.filter((a,t)=>t!==e);x(e=>({...e,prices:a}))})(t)},"X"))),(0,e.createElement)(o,{type:"button",variant:"outline",onClick:()=>{x(e=>({...e,prices:[...e.prices,{room_type:"",price:0}]}))}},"+ Tambah Harga")),(0,e.createElement)("div",{className:"p-4 border border-gray-200 rounded-md mt-6"},(0,e.createElement)("h4",{className:"font-semibold text-gray-700 mb-1"},"Link Pesawat"),(0,e.createElement)("p",{className:"text-sm text-gray-500 mb-3"},"Tahan Ctrl/Cmd untuk memilih lebih dari satu."),(0,e.createElement)("select",{multiple:!0,name:"flight_ids",value:v.flight_ids,onChange:e=>{const a=Array.from(e.target.selectedOptions,e=>parseInt(e.value));x(e=>({...e,flight_ids:a}))},className:"w-full h-32 px-3 py-2 border border-gray-300 rounded-md shadow-sm"},h.flights?.map(a=>(0,e.createElement)("option",{key:a.id,value:a.id},a.airline," (",a.flight_number,") - ",a.departure_airport_code," ke ",a.arrival_airport_code)))),(0,e.createElement)("div",{className:"p-4 border border-gray-200 rounded-md mt-6"},(0,e.createElement)("h4",{className:"font-semibold text-gray-700 mb-3"},"Link Hotel"),v.hotel_bookings.map((a,l)=>(0,e.createElement)("div",{key:l,className:"grid grid-cols-3 gap-2 mb-2 p-2 border rounded"},(0,e.createElement)("select",{value:a.hotel_id,onChange:e=>D(l,"hotel_id",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm bg-white"},(0,e.createElement)("option",{value:""},"Pilih Hotel"),h.hotels?.map(a=>(0,e.createElement)("option",{key:a.id,value:a.id},a.name," (",a.city,")"))),(0,e.createElement)("input",{type:"date",placeholder:"Check-in",value:t(a.check_in_date),onChange:e=>D(l,"check_in_date",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm"}),(0,e.createElement)("div",{className:"flex"},(0,e.createElement)("input",{type:"date",placeholder:"Check-out",value:t(a.check_out_date),onChange:e=>D(l,"check_out_date",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm"}),(0,e.createElement)(o,{type:"button",variant:"danger",onClick:()=>(e=>{const a=v.hotel_bookings.filter((a,t)=>t!==e);x(e=>({...e,hotel_bookings:a}))})(l),className:"ml-2"},"X")))),(0,e.createElement)(o,{type:"button",variant:"outline",onClick:()=>{x(e=>({...e,hotel_bookings:[...e.hotel_bookings,{hotel_id:"",check_in_date:"",check_out_date:""}]}))}},"+ Tambah Hotel")))))},E=()=>{const a=(0,e.useCallback)(async()=>({packages:await u.get("packages")}),[]),{list:h,dependencies:b,isLoading:y,error:E,successMessage:k,isModalOpen:v,isEditing:x,currentItem:_,formState:w,handleChange:N,handleAddNew:C,handleCloseModal:S,handleSubmit:T,handleDelete:D,fetchData:P,setError:M,setFormState:j}=p("jamaah",{full_name:"",package_id:"",birth_date:"",gender:"Laki-laki",address:"",phone:"",email:"",passport_number:"",passport_expiry:"",ktp_number:"",room_type:"Quad",total_price:0,status:"pending",notes:""},a),[B,K]=(0,e.useState)(null),[q,L]=(0,e.useState)(null),[A,$]=(0,e.useState)([]),[F,J]=(0,e.useState)(!1),[H,I]=(0,e.useState)(null),[R,O]=(0,e.useState)(!1),[G,U]=(0,e.useState)(null),V=async(e,a,t)=>{if(!e)return;const l=new FormData;l.append("file",e),l.append("jamaah_id",t),l.append("upload_type",a);try{const e=u.getToken(),t=await fetch(`${d.api_url}uploads`,{method:"POST",headers:{Authorization:`Bearer ${e}`},body:l});if(!t.ok){const e=await t.json();throw new Error(e.message||"Upload gagal")}const n=await t.json();j(e=>({...e,[a]:n.file_url})),P(),"ktp_scan"===a&&K(null),"passport_scan"===a&&L(null)}catch(e){M(`Upload ${a} gagal: ${e.message}`)}},W=async e=>{if(e){O(!0),U(null);try{const a=await u.get(`payments?jamaah_id=${e}`);$(a)}catch(e){U(`Gagal memuat pembayaran: ${e.message}`)}finally{O(!1)}}},z=()=>{S(),$([]),U(null),K(null),L(null)},Q=(e=null)=>{I(e),J(!0)},X=()=>{I(null),J(!1),U(null)},Y=[{key:"full_name",label:"Nama Jemaah"},{key:"package",label:"Paket",render:e=>b.packages?.find(a=>a.id==e.package_id)?.name||"N/A"},{key:"phone",label:"Telepon"},{key:"email",label:"Email"},{key:"payment_status",label:"Status Bayar",render:a=>{const t=a.payment_status||"Belum Lunas";return(0,e.createElement)("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${{Lunas:"bg-green-100 text-green-800",Cicil:"bg-yellow-100 text-yellow-800","Belum Lunas":"bg-red-100 text-red-800"}[t]}`},t)}},{key:"amount_paid",label:"Total Bayar",render:e=>l(e.amount_paid)},{key:"status",label:"Status Jemaah"}];return(0,e.createElement)("div",null,(0,e.createElement)("div",{className:"flex justify-between items-center mb-6"},(0,e.createElement)("h2",{className:"text-2xl font-semibold text-gray-800"},"Manajemen Jemaah (Manifest)"),(0,e.createElement)(o,{onClick:C},"Tambah Jemaah Baru")),(0,e.createElement)(c,{message:E,type:"error"}),(0,e.createElement)(c,{message:k,type:"success"}),y?(0,e.createElement)(i,null):(0,e.createElement)(g,{columns:Y,data:h,onEdit:e=>{handleEdit(e),W(e.id)},onDelete:D}),(0,e.createElement)(m,{show:v,onClose:z,title:x?"Edit Jemaah":"Tambah Jemaah Baru",footer:(0,e.createElement)(e.Fragment,null,(0,e.createElement)(o,{onClick:z,variant:"secondary",className:"mr-2"},"Batal"),(0,e.createElement)(o,{onClick:T,type:"submit",form:"jamaah-form"},"Simpan Jemaah"))},(0,e.createElement)(c,{message:E,type:"error"}),(0,e.createElement)("form",{id:"jamaah-form",onSubmit:T,className:"space-y-4"},(0,e.createElement)(n,{label:"Nama Lengkap",name:"full_name",value:w.full_name,onChange:N,required:!0}),(0,e.createElement)(s,{label:"Paket",name:"package_id",value:w.package_id,onChange:N,required:!0},(0,e.createElement)("option",{value:""},"Pilih Paket"),b.packages?.map(a=>(0,e.createElement)("option",{key:a.id,value:a.id},a.name," ",(e=>{if(!e.prices||0===e.prices.length)return"(Harga belum diatur)";const a=Math.min(...e.prices.map(e=>e.price));return`(Mulai dari ${l(a)})`})(a)))),(0,e.createElement)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4"},(0,e.createElement)(n,{label:"Tanggal Lahir",name:"birth_date",type:"date",value:t(w.birth_date),onChange:N}),(0,e.createElement)(s,{label:"Jenis Kelamin",name:"gender",value:w.gender,onChange:N},(0,e.createElement)("option",{value:"Laki-laki"},"Laki-laki"),(0,e.createElement)("option",{value:"Perempuan"},"Perempuan"))),(0,e.createElement)(r,{label:"Alamat",name:"address",value:w.address,onChange:N}),(0,e.createElement)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4"},(0,e.createElement)(n,{label:"Telepon",name:"phone",value:w.phone,onChange:N,required:!0}),(0,e.createElement)(n,{label:"Email",name:"email",type:"email",value:w.email,onChange:N})),(0,e.createElement)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4"},(0,e.createElement)(n,{label:"No. KTP",name:"ktp_number",value:w.ktp_number,onChange:N}),(0,e.createElement)(n,{label:"No. Paspor",name:"passport_number",value:w.passport_number,onChange:N})),(0,e.createElement)(n,{label:"Tgl Kadaluarsa Paspor",name:"passport_expiry",type:"date",value:t(w.passport_expiry),onChange:N}),(0,e.createElement)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4"},(0,e.createElement)(s,{label:"Tipe Kamar",name:"room_type",value:w.room_type,onChange:N},(0,e.createElement)("option",{value:"Quad"},"Quad (4)"),(0,e.createElement)("option",{value:"Triple"},"Triple (3)"),(0,e.createElement)("option",{value:"Double"},"Double (2)")),(0,e.createElement)(n,{label:"Total Harga Paket",name:"total_price",type:"number",value:w.total_price,onChange:N,required:!0})),(0,e.createElement)(s,{label:"Status Jemaah",name:"status",value:w.status,onChange:N,required:!0},(0,e.createElement)("option",{value:"pending"},"Pending"),(0,e.createElement)("option",{value:"confirmed"},"Confirmed"),(0,e.createElement)("option",{value:"cancelled"},"Cancelled")),(0,e.createElement)(r,{label:"Catatan",name:"notes",value:w.notes,onChange:N}),x&&(0,e.createElement)(e.Fragment,null,(0,e.createElement)("div",{className:"p-4 border border-gray-200 rounded-md mt-6"},(0,e.createElement)("h4",{className:"font-semibold text-gray-700 mb-3"},"Upload Dokumen"),(0,e.createElement)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4"},(0,e.createElement)("div",null,(0,e.createElement)(n,{label:`Upload KTP (File: ${w.ktp_scan?"Ada":"Kosong"})`,type:"file",onChange:e=>K(e.target.files[0])}),(0,e.createElement)(o,{type:"button",onClick:()=>V(B,"ktp_scan",_.id),disabled:!B,className:"mt-2",variant:"outline"},"Upload KTP")),(0,e.createElement)("div",null,(0,e.createElement)(n,{label:`Upload Paspor (File: ${w.passport_scan?"Ada":"Kosong"})`,type:"file",onChange:e=>L(e.target.files[0])}),(0,e.createElement)(o,{type:"button",onClick:()=>V(q,"passport_scan",_.id),disabled:!q,className:"mt-2",variant:"outline"},"Upload Paspor")))),(0,e.createElement)("div",{className:"p-4 border border-gray-200 rounded-md mt-6"},(0,e.createElement)("div",{className:"flex justify-between items-center mb-3"},(0,e.createElement)("h4",{className:"font-semibold text-gray-700"},"Riwayat Pembayaran"),(0,e.createElement)(o,{type:"button",variant:"primary",onClick:()=>Q(null)},"Tambah Pembayaran")),(0,e.createElement)(c,{message:G,type:"error"}),R&&!A.length?(0,e.createElement)(i,null):(0,e.createElement)("div",{className:"max-h-60 overflow-y-auto"},(0,e.createElement)("table",{className:"min-w-full divide-y divide-gray-200"},(0,e.createElement)("thead",{className:"bg-gray-50"},(0,e.createElement)("tr",null,(0,e.createElement)("th",{className:"px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase"},"Tgl"),(0,e.createElement)("th",{className:"px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase"},"Jumlah"),(0,e.createElement)("th",{className:"px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase"},"Tahap"),(0,e.createElement)("th",{className:"px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase"},"Status"),(0,e.createElement)("th",{className:"px-3 py-2 text-right text-xs font-medium text-gray-500 uppercase"},"Aksi"))),(0,e.createElement)("tbody",{className:"bg-white divide-y divide-gray-200"},0===A.length?(0,e.createElement)("tr",null,(0,e.createElement)("td",{colSpan:"5",className:"text-center py-4 text-sm text-gray-500"},"Belum ada pembayaran.")):A.map(a=>(0,e.createElement)("tr",{key:a.id},(0,e.createElement)("td",{className:"px-3 py-2 text-sm"},t(a.payment_date)),(0,e.createElement)("td",{className:"px-3 py-2 text-sm"},l(a.amount)),(0,e.createElement)("td",{className:"px-3 py-2 text-sm"},a.payment_stage),(0,e.createElement)("td",{className:"px-3 py-2 text-sm"},(0,e.createElement)("span",{className:"px-2 py-0.5 rounded-full text-xs "+("verified"===a.status?"bg-green-100 text-green-800":"bg-yellow-100 text-yellow-800")},a.status)),(0,e.createElement)("td",{className:"px-3 py-2 text-sm text-right"},(0,e.createElement)("button",{type:"button",onClick:()=>Q(a),className:"text-blue-600 hover:text-blue-800 mr-2"},"Edit"),(0,e.createElement)("button",{type:"button",onClick:()=>(async e=>{if(window.confirm("Yakin ingin menghapus pembayaran ini?")){O(!0),U(null);try{await u.del(`payments/${e}`),await W(_.id),await P()}catch(e){U(`Gagal menghapus pembayaran: ${e.message}`)}finally{O(!1)}}})(a.id),className:"text-red-600 hover:text-red-800"},"Hapus"))))))))))),F&&(0,e.createElement)(f,{show:F,onClose:X,payment:H,onSave:async(e,a)=>{O(!0),U(null);try{let t;const l={...e,jamaah_id:_.id};t=H?await u.put(`payments/${H.id}`,l):await u.post("payments",l),a&&await(async(e,a)=>{const t=new FormData;t.append("file",a);const l=u.getToken(),n=await fetch(`${d.api_url}payments/${e}/upload_proof`,{method:"POST",headers:{Authorization:`Bearer ${l}`},body:t});if(!n.ok){const e=await n.json();throw new Error(e.message||"Upload bukti gagal")}})(t.id,a),await W(_.id),await P(),X()}catch(e){U(`Gagal menyimpan pembayaran: ${e.message}`)}finally{O(!1)}},isLoading:R,error:G}))},f=({show:a,onClose:l,payment:i,onSave:d,isLoading:u,error:p})=>{const[g,h]=(0,e.useState)({payment_date:t(new Date),amount:0,payment_stage:"DP 1",status:"pending",notes:"",proof_url:""}),[b,y]=(0,e.useState)(null);(0,e.useEffect)(()=>{h(i?{payment_date:t(i.payment_date),amount:i.amount,payment_stage:i.payment_stage,status:i.status,notes:i.notes||"",proof_url:i.proof_url||""}:{payment_date:t(new Date),amount:0,payment_stage:"DP 1",status:"pending",notes:"",proof_url:""}),y(null)},[i,a]);const E=e=>{const{name:a,value:t}=e.target;h(e=>({...e,[a]:t}))},f=e=>{e.preventDefault(),d(g,b)};return(0,e.createElement)(m,{show:a,onClose:l,title:i?"Edit Pembayaran":"Tambah Pembayaran Baru",footer:(0,e.createElement)(e.Fragment,null,(0,e.createElement)(o,{onClick:l,variant:"secondary",className:"mr-2",disabled:u},"Batal"),(0,e.createElement)(o,{onClick:f,type:"submit",form:"payment-form",disabled:u},u?"Menyimpan...":"Simpan Pembayaran"))},(0,e.createElement)(c,{message:p,type:"error"}),(0,e.createElement)("form",{id:"payment-form",onSubmit:f,className:"space-y-4"},(0,e.createElement)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4"},(0,e.createElement)(n,{label:"Tanggal Bayar",name:"payment_date",type:"date",value:g.payment_date,onChange:E,required:!0}),(0,e.createElement)(n,{label:"Jumlah Bayar",name:"amount",type:"number",value:g.amount,onChange:E,required:!0})),(0,e.createElement)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4"},(0,e.createElement)(n,{label:"Tahap Pembayaran",name:"payment_stage",value:g.payment_stage,onChange:E,placeholder:"e.g., DP 1, Cicilan 2, Pelunasan"}),(0,e.createElement)(s,{label:"Status",name:"status",value:g.status,onChange:E,required:!0},(0,e.createElement)("option",{value:"pending"},"Pending"),(0,e.createElement)("option",{value:"verified"},"Verified"),(0,e.createElement)("option",{value:"rejected"},"Rejected"))),(0,e.createElement)(r,{label:"Catatan",name:"notes",value:g.notes,onChange:E}),(0,e.createElement)(n,{label:"Upload Bukti Pembayaran",type:"file",onChange:e=>{y(e.target.files[0])}}),g.proof_url&&(0,e.createElement)("p",{className:"text-sm text-gray-600"},"Bukti saat ini: ",(0,e.createElement)("a",{href:g.proof_url,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:underline"},"Lihat File"))))},k=()=>{const a={transaction_date:t(new Date),type:"expense",category:"",description:"",amount:0},{list:d,isLoading:u,error:h,successMessage:b,isModalOpen:y,isEditing:E,formState:f,handleChange:k,handleAddNew:v,handleEdit:x,handleCloseModal:_,handleSubmit:w,handleDelete:N}=p("finance",a),C=[{key:"transaction_date",label:"Tanggal",render:e=>t(e.transaction_date)},{key:"type",label:"Tipe",render:a=>(0,e.createElement)("span",{className:"px-2 py-1 rounded-full text-xs font-medium "+("income"===a.type?"bg-green-100 text-green-800":"bg-red-100 text-red-800")},a.type)},{key:"category",label:"Kategori"},{key:"description",label:"Deskripsi"},{key:"amount",label:"Jumlah",render:e=>l(e.amount)}],S=(0,e.useMemo)(()=>d.reduce((e,a)=>"income"===a.type?e+parseFloat(a.amount):"expense"===a.type?e-parseFloat(a.amount):e,0),[d]);return(0,e.createElement)("div",null,(0,e.createElement)("div",{className:"flex justify-between items-center mb-6"},(0,e.createElement)("h2",{className:"text-2xl font-semibold text-gray-800"},"Manajemen Keuangan"),(0,e.createElement)("div",{className:"flex items-center space-x-4"},(0,e.createElement)("div",{className:"text-right"},(0,e.createElement)("span",{className:"text-sm text-gray-500"},"Total Saldo"),(0,e.createElement)("p",{className:"text-xl font-semibold "+(S>=0?"text-green-600":"text-red-600")},l(S))),(0,e.createElement)(o,{onClick:v},"Tambah Transaksi"))),(0,e.createElement)(c,{message:h,type:"error"}),(0,e.createElement)(c,{message:b,type:"success"}),u?(0,e.createElement)(i,null):(0,e.createElement)(g,{columns:C,data:d,onEdit:x,onDelete:N}),(0,e.createElement)(m,{show:y,onClose:_,title:E?"Edit Transaksi":"Tambah Transaksi Baru",footer:(0,e.createElement)(e.Fragment,null,(0,e.createElement)(o,{onClick:_,variant:"secondary",className:"mr-2"},"Batal"),(0,e.createElement)(o,{onClick:w,type:"submit",form:"finance-form"},"Simpan"))},(0,e.createElement)("form",{id:"finance-form",onSubmit:w},(0,e.createElement)(n,{label:"Tanggal",name:"transaction_date",type:"date",value:t(f.transaction_date),onChange:k,required:!0}),(0,e.createElement)(s,{label:"Tipe Transaksi",name:"type",value:f.type,onChange:k,required:!0},(0,e.createElement)("option",{value:"expense"},"Pengeluaran (Expense)"),(0,e.createElement)("option",{value:"income"},"Pemasukan (Income)")),(0,e.createElement)(n,{label:"Kategori",name:"category",value:f.category,onChange:k,placeholder:"e.g., Tiket Pesawat, Akomodasi, Gaji"}),(0,e.createElement)(n,{label:"Jumlah",name:"amount",type:"number",value:f.amount,onChange:k,required:!0}),(0,e.createElement)(r,{label:"Deskripsi",name:"description",value:f.description,onChange:k}))))},v=()=>{const a=(0,e.useCallback)(async()=>{const[e,a]=await Promise.all([u.get("users"),u.get("jamaah")]);return{users:e,jamaah:a}},[]),{list:l,dependencies:d,isLoading:h,error:b,successMessage:y,isModalOpen:E,isEditing:f,formState:k,handleChange:v,handleAddNew:x,handleEdit:_,handleCloseModal:w,handleSubmit:N,handleDelete:C}=p("tasks",{title:"",description:"",assigned_to_user_id:"",jamaah_id:"",due_date:"",status:"pending",priority:"medium"},a),S=[{key:"title",label:"Judul Tugas"},{key:"assigned_to",label:"Ditugaskan Kepada",render:e=>d.users?.find(a=>a.id==e.assigned_to_user_id)?.full_name||"N/A"},{key:"jamaah",label:"Terkait Jemaah",render:e=>d.jamaah?.find(a=>a.id==e.jamaah_id)?.full_name||"N/A"},{key:"due_date",label:"Batas Waktu",render:e=>t(e.due_date)},{key:"priority",label:"Prioritas"},{key:"status",label:"Status"}];return(0,e.createElement)("div",null,(0,e.createElement)("div",{className:"flex justify-between items-center mb-6"},(0,e.createElement)("h2",{className:"text-2xl font-semibold text-gray-800"},"Manajemen Tugas"),(0,e.createElement)(o,{onClick:x},"Tambah Tugas Baru")),(0,e.createElement)(c,{message:b,type:"error"}),(0,e.createElement)(c,{message:y,type:"success"}),h?(0,e.createElement)(i,null):(0,e.createElement)(g,{columns:S,data:l,onEdit:_,onDelete:C}),(0,e.createElement)(m,{show:E,onClose:w,title:f?"Edit Tugas":"Tambah Tugas Baru",footer:(0,e.createElement)(e.Fragment,null,(0,e.createElement)(o,{onClick:w,variant:"secondary",className:"mr-2"},"Batal"),(0,e.createElement)(o,{onClick:N,type:"submit",form:"task-form"},"Simpan"))},(0,e.createElement)("form",{id:"task-form",onSubmit:N},(0,e.createElement)(n,{label:"Judul Tugas",name:"title",value:k.title,onChange:v,required:!0}),(0,e.createElement)(r,{label:"Deskripsi",name:"description",value:k.description,onChange:v}),(0,e.createElement)(s,{label:"Tugaskan Kepada",name:"assigned_to_user_id",value:k.assigned_to_user_id,onChange:v},(0,e.createElement)("option",{value:""},"Pilih Staff"),d.users?.map(a=>(0,e.createElement)("option",{key:a.id,value:a.id},a.full_name))),(0,e.createElement)(s,{label:"Terkait Jemaah (Opsional)",name:"jamaah_id",value:k.jamaah_id,onChange:v},(0,e.createElement)("option",{value:""},"Pilih Jemaah"),d.jamaah?.map(a=>(0,e.createElement)("option",{key:a.id,value:a.id},a.full_name))),(0,e.createElement)(n,{label:"Batas Waktu",name:"due_date",type:"date",value:t(k.due_date),onChange:v}),(0,e.createElement)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4"},(0,e.createElement)(s,{label:"Prioritas",name:"priority",value:k.priority,onChange:v},(0,e.createElement)("option",{value:"low"},"Rendah"),(0,e.createElement)("option",{value:"medium"},"Sedang"),(0,e.createElement)("option",{value:"high"},"Tinggi")),(0,e.createElement)(s,{label:"Status",name:"status",value:k.status,onChange:v},(0,e.createElement)("option",{value:"pending"},"Pending"),(0,e.createElement)("option",{value:"in_progress"},"In Progress"),(0,e.createElement)("option",{value:"completed"},"Completed"))))))},x=()=>{const a=(0,e.useCallback)(async()=>({roles:await u.get("roles")}),[]),{list:t,dependencies:l,isLoading:r,error:d,successMessage:h,isModalOpen:b,isEditing:y,formState:E,handleChange:f,handleAddNew:k,handleEdit:v,handleCloseModal:x,handleSubmit:_,handleDelete:w}=p("users",{email:"",full_name:"",role:"agent",phone:"",status:"active",password:""},a),N=[{key:"full_name",label:"Nama Lengkap"},{key:"email",label:"Email (Login)"},{key:"role",label:"Role",render:e=>l.roles?.find(a=>a.role_key===e.role)?.role_name||e.role},{key:"phone",label:"Telepon"},{key:"status",label:"Status"}];return(0,e.createElement)("div",null,(0,e.createElement)("div",{className:"flex justify-between items-center mb-6"},(0,e.createElement)("h2",{className:"text-2xl font-semibold text-gray-800"},"Manajemen Pengguna (Staff)"),(0,e.createElement)(o,{onClick:k},"Tambah Staff Baru")),(0,e.createElement)(c,{message:d,type:"error"}),(0,e.createElement)(c,{message:h,type:"success"}),r?(0,e.createElement)(i,null):(0,e.createElement)(g,{columns:N,data:t,onEdit:v,onDelete:w}),(0,e.createElement)(m,{show:b,onClose:x,title:y?"Edit Staff":"Tambah Staff Baru",footer:(0,e.createElement)(e.Fragment,null,(0,e.createElement)(o,{onClick:x,variant:"secondary",className:"mr-2"},"Batal"),(0,e.createElement)(o,{onClick:_,type:"submit",form:"user-form"},"Simpan"))},(0,e.createElement)("form",{id:"user-form",onSubmit:_},(0,e.createElement)(n,{label:"Nama Lengkap",name:"full_name",value:E.full_name,onChange:f,required:!0}),(0,e.createElement)(n,{label:"Email (Untuk Login)",name:"email",type:"email",value:E.email,onChange:f,required:!0,disabled:y}),y?(0,e.createElement)(n,{label:"Password",name:"password",type:"password",value:E.password,onChange:f,placeholder:"Kosongkan jika tidak ingin mengubah"}):(0,e.createElement)(n,{label:"Password",name:"password",type:"password",value:E.password,onChange:f,required:!0}),(0,e.createElement)(n,{label:"Telepon",name:"phone",value:E.phone,onChange:f}),(0,e.createElement)(s,{label:"Role",name:"role",value:E.role,onChange:f,required:!0},(0,e.createElement)("option",{value:""},"Pilih Role"),l.roles?.map(a=>(0,e.createElement)("option",{key:a.id,value:a.role_key},a.role_name))),(0,e.createElement)(s,{label:"Status",name:"status",value:E.status,onChange:f},(0,e.createElement)("option",{value:"active"},"Active"),(0,e.createElement)("option",{value:"inactive"},"Inactive")))))},_=()=>{const{list:a,isLoading:t,error:l,successMessage:s,isModalOpen:d,isEditing:u,formState:h,handleChange:b,handleAddNew:y,handleEdit:E,handleCloseModal:f,handleSubmit:k,handleDelete:v}=p("categories",{name:"",description:""});return(0,e.createElement)("div",null,(0,e.createElement)("div",{className:"flex justify-between items-center mb-6"},(0,e.createElement)("h2",{className:"text-2xl font-semibold text-gray-800"},"Manajemen Kategori Paket"),(0,e.createElement)(o,{onClick:y},"Tambah Kategori")),(0,e.createElement)(c,{message:l,type:"error"}),(0,e.createElement)(c,{message:s,type:"success"}),t?(0,e.createElement)(i,null):(0,e.createElement)(g,{columns:[{key:"name",label:"Nama Kategori"},{key:"description",label:"Deskripsi"}],data:a,onEdit:E,onDelete:v}),(0,e.createElement)(m,{show:d,onClose:f,title:u?"Edit Kategori":"Tambah Kategori",footer:(0,e.createElement)(e.Fragment,null,(0,e.createElement)(o,{onClick:f,variant:"secondary",className:"mr-2"},"Batal"),(0,e.createElement)(o,{onClick:k,type:"submit",form:"category-form"},"Simpan"))},(0,e.createElement)("form",{id:"category-form",onSubmit:k},(0,e.createElement)(n,{label:"Nama Kategori",name:"name",value:h.name,onChange:b,required:!0}),(0,e.createElement)(r,{label:"Deskripsi",name:"description",value:h.description,onChange:b}))))},w=()=>{const{list:a,isLoading:t,error:l,successMessage:r,isModalOpen:s,isEditing:d,formState:u,handleChange:h,handleAddNew:b,handleEdit:y,handleCloseModal:E,handleSubmit:f,handleDelete:k}=p("flights",{airline:"",flight_number:"",departure_airport_code:"",arrival_airport_code:"",departure_time:"",arrival_time:"",cost_per_seat:0,total_seats:0}),v=[{key:"airline",label:"Maskapai"},{key:"flight_number",label:"No. Penerbangan"},{key:"departure_airport_code",label:"Dari"},{key:"arrival_airport_code",label:"Ke"},{key:"departure_time",label:"Waktu Berangkat",render:e=>new Date(e.departure_time).toLocaleString("id-ID")},{key:"total_seats",label:"Kapasitas"}];return(0,e.createElement)("div",null,(0,e.createElement)("div",{className:"flex justify-between items-center mb-6"},(0,e.createElement)("h2",{className:"text-2xl font-semibold text-gray-800"},"Manajemen Data Pesawat"),(0,e.createElement)(o,{onClick:b},"Tambah Data Pesawat")),(0,e.createElement)(c,{message:l,type:"error"}),(0,e.createElement)(c,{message:r,type:"success"}),t?(0,e.createElement)(i,null):(0,e.createElement)(g,{columns:v,data:a,onEdit:y,onDelete:k}),(0,e.createElement)(m,{show:s,onClose:E,title:d?"Edit Data Pesawat":"Tambah Data Pesawat",footer:(0,e.createElement)(e.Fragment,null,(0,e.createElement)(o,{onClick:E,variant:"secondary",className:"mr-2"},"Batal"),(0,e.createElement)(o,{onClick:f,type:"submit",form:"flight-form"},"Simpan"))},(0,e.createElement)("form",{id:"flight-form",onSubmit:f,className:"space-y-4"},(0,e.createElement)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4"},(0,e.createElement)(n,{label:"Maskapai",name:"airline",value:u.airline,onChange:h,required:!0}),(0,e.createElement)(n,{label:"No. Penerbangan",name:"flight_number",value:u.flight_number,onChange:h,required:!0})),(0,e.createElement)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4"},(0,e.createElement)(n,{label:"Kode Airport (Berangkat)",name:"departure_airport_code",value:u.departure_airport_code,onChange:h,required:!0,placeholder:"e.g., JED"}),(0,e.createElement)(n,{label:"Kode Airport (Tiba)",name:"arrival_airport_code",value:u.arrival_airport_code,onChange:h,required:!0,placeholder:"e.g., CGK"})),(0,e.createElement)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4"},(0,e.createElement)(n,{label:"Waktu Berangkat",name:"departure_time",type:"datetime-local",value:u.departure_time,onChange:h,required:!0}),(0,e.createElement)(n,{label:"Waktu Tiba",name:"arrival_time",type:"datetime-local",value:u.arrival_time,onChange:h,required:!0})),(0,e.createElement)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4"},(0,e.createElement)(n,{label:"Biaya per Kursi",name:"cost_per_seat",type:"number",value:u.cost_per_seat,onChange:h}),(0,e.createElement)(n,{label:"Total Kursi",name:"total_seats",type:"number",value:u.total_seats,onChange:h})))))},N=()=>{const{list:a,isLoading:t,error:l,successMessage:s,isModalOpen:d,isEditing:u,formState:h,handleChange:b,handleAddNew:y,handleEdit:E,handleCloseModal:f,handleSubmit:k,handleDelete:v}=p("hotels",{name:"",address:"",city:"Mekkah",country:"Saudi Arabia",phone:"",email:"",rating:5});return(0,e.createElement)("div",null,(0,e.createElement)("div",{className:"flex justify-between items-center mb-6"},(0,e.createElement)("h2",{className:"text-2xl font-semibold text-gray-800"},"Manajemen Data Hotel"),(0,e.createElement)(o,{onClick:y},"Tambah Data Hotel")),(0,e.createElement)(c,{message:l,type:"error"}),(0,e.createElement)(c,{message:s,type:"success"}),t?(0,e.createElement)(i,null):(0,e.createElement)(g,{columns:[{key:"name",label:"Nama Hotel"},{key:"city",label:"Kota"},{key:"rating",label:"Bintang",render:e=>`${e.rating} Bintang`},{key:"phone",label:"Telepon"}],data:a,onEdit:E,onDelete:v}),(0,e.createElement)(m,{show:d,onClose:f,title:u?"Edit Data Hotel":"Tambah Data Hotel",footer:(0,e.createElement)(e.Fragment,null,(0,e.createElement)(o,{onClick:f,variant:"secondary",className:"mr-2"},"Batal"),(0,e.createElement)(o,{onClick:k,type:"submit",form:"hotel-form"},"Simpan"))},(0,e.createElement)("form",{id:"hotel-form",onSubmit:k,className:"space-y-4"},(0,e.createElement)(n,{label:"Nama Hotel",name:"name",value:h.name,onChange:b,required:!0}),(0,e.createElement)(r,{label:"Alamat",name:"address",value:h.address,onChange:b}),(0,e.createElement)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4"},(0,e.createElement)(n,{label:"Kota",name:"city",value:h.city,onChange:b}),(0,e.createElement)(n,{label:"Negara",name:"country",value:h.country,onChange:b}),(0,e.createElement)(n,{label:"Bintang (1-5)",name:"rating",type:"number",min:"1",max:"5",value:h.rating,onChange:b})),(0,e.createElement)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4"},(0,e.createElement)(n,{label:"Telepon",name:"phone",value:h.phone,onChange:b}),(0,e.createElement)(n,{label:"Email",name:"email",type:"email",value:h.email,onChange:b})))))},C=()=>{const{list:a,isLoading:t,error:l,successMessage:r,isModalOpen:s,isEditing:d,formState:u,handleChange:h,handleAddNew:b,handleEdit:y,handleCloseModal:E,handleSubmit:f,handleDelete:k}=p("roles",{role_key:"",role_name:""});return(0,e.createElement)("div",null,(0,e.createElement)("div",{className:"flex justify-between items-center mb-6"},(0,e.createElement)("h2",{className:"text-2xl font-semibold text-gray-800"},"Manajemen Role Karyawan"),(0,e.createElement)(o,{onClick:b},"Tambah Role Baru")),(0,e.createElement)(c,{message:l,type:"error"}),(0,e.createElement)(c,{message:r,type:"success"}),t?(0,e.createElement)(i,null):(0,e.createElement)(g,{columns:[{key:"role_name",label:"Nama Role"},{key:"role_key",label:"Kunci Role (untuk sistem)"}],data:a,onEdit:y,onDelete:k}),(0,e.createElement)(m,{show:s,onClose:E,title:d?"Edit Role":"Tambah Role Baru",footer:(0,e.createElement)(e.Fragment,null,(0,e.createElement)(o,{onClick:E,variant:"secondary",className:"mr-2"},"Batal"),(0,e.createElement)(o,{onClick:f,type:"submit",form:"role-form"},"Simpan"))},(0,e.createElement)("form",{id:"role-form",onSubmit:f},(0,e.createElement)(n,{label:"Nama Role",name:"role_name",value:u.role_name,onChange:h,required:!0,placeholder:"e.g., Staf Keuangan"}),(0,e.createElement)(n,{label:"Kunci Role",name:"role_key",value:u.role_key,onChange:h,required:!0,placeholder:"e.g., finance_staff"}))))},S=({user:a,onLogout:t})=>(0,e.createElement)("header",{className:"bg-white shadow-md"},(0,e.createElement)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8"},(0,e.createElement)("div",{className:"flex justify-between items-center h-16"},(0,e.createElement)("div",{className:"flex-shrink-0"},(0,e.createElement)("span",{className:"text-2xl font-bold text-blue-600"},"Travel"),(0,e.createElement)("span",{className:"text-2xl font-bold text-gray-700"},"Manajemen")),(0,e.createElement)("div",{className:"text-sm text-gray-600"},"Selamat datang, ",(0,e.createElement)("span",{className:"font-medium text-gray-800"},a.name||"Pengguna"))))),T=({currentView:a,setView:t})=>(0,e.createElement)("nav",{className:"bg-white shadow-sm"},(0,e.createElement)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8"},(0,e.createElement)("div",{className:"flex space-x-6"},[{key:"dashboard",label:"Dashboard"},{key:"packages",label:"Paket"},{key:"categories",label:"Kategori Paket"},{key:"jamaah",label:"Jemaah (Manifest)"},{key:"finance",label:"Keuangan"},{key:"tasks",label:"Tugas"},{key:"data_master",label:"Data Master",subItems:[{key:"flights",label:"Data Pesawat"},{key:"hotels",label:"Data Hotel"}]},{key:"hr",label:"HRD",subItems:[{key:"users",label:"Staff"},{key:"roles",label:"Roles"}]}].map(l=>l.subItems?(0,e.createElement)(P,{key:l.key,item:l,currentView:a,setView:t}):(0,e.createElement)(D,{key:l.key,item:l,isActive:a===l.key,onClick:()=>t(l.key)}))))),D=({item:a,isActive:t,onClick:l})=>(0,e.createElement)("button",{onClick:l,className:"px-3 py-4 text-sm font-medium border-b-2 transition-all duration-150\n            "+(t?"border-blue-500 text-blue-600":"border-transparent text-gray-600 hover:border-gray-300 hover:text-gray-800")},a.label),P=({item:a,currentView:t,setView:l})=>{const[n,r]=(0,e.useState)(!1),s=a.subItems.some(e=>e.key===t);return(0,e.createElement)("div",{className:"relative",onMouseLeave:()=>r(!1)},(0,e.createElement)("button",{onMouseEnter:()=>r(!0),className:"px-3 py-4 text-sm font-medium border-b-2 transition-all duration-150 flex items-center\n                    "+(s?"border-blue-500 text-blue-600":"border-transparent text-gray-600 hover:border-gray-300 hover:text-gray-800")},a.label,(0,e.createElement)("svg",{className:"w-4 h-4 ml-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},(0,e.createElement)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M19 9l-7 7-7-7"}))),n&&(0,e.createElement)("div",{className:"absolute z-10 top-full left-0 mt-0 w-48 bg-white shadow-lg rounded-md border border-gray-200 py-1"},a.subItems.map(a=>(0,e.createElement)("button",{key:a.key,onClick:()=>{l(a.key),r(!1)},className:"block w-full text-left px-4 py-2 text-sm \n                                "+(t===a.key?"bg-blue-50 text-blue-600":"text-gray-700 hover:bg-gray-100")},a.label))))},M=()=>{const[a,t]=(0,e.useState)("dashboard"),[l,n]=(0,e.useState)(d.user);return(0,e.useEffect)(()=>{"super_admin"===d.user.role&&(async()=>{if(d.user&&d.user.token)try{await u.get("users/me"),n(d.user)}catch(e){console.warn("Token kadaluarsa, mencoba auto-login...");try{const e=await u.post("auth/wp-login",{});d.user.token=e.token,n(e.user)}catch(e){console.error("Auto-login gagal:",e),n({name:"Error",role:"guest",token:null})}}else if(d.user&&"super_admin"===d.user.role&&!d.user.token)try{console.log("Mencoba auto-login Super Admin...");const e=await u.post("auth/wp-login",{});d.user.token=e.token,n(e.user)}catch(e){console.error("Gagal auto-login Super Admin:",e)}})()},[]),(0,e.createElement)("div",{className:"min-h-screen bg-gray-100"},(0,e.createElement)(S,{user:l}),(0,e.createElement)(T,{currentView:a,setView:t}),(0,e.createElement)("main",null,(0,e.createElement)("div",{className:"max-w-7xl mx-auto py-6 sm:px-6 lg:px-8"},(0,e.createElement)("div",{className:"bg-white p-6 rounded-lg shadow-lg"},(()=>{switch(a){case"dashboard":default:return(0,e.createElement)(h,null);case"packages":return(0,e.createElement)(y,null);case"jamaah":return(0,e.createElement)(E,null);case"finance":return(0,e.createElement)(k,null);case"tasks":return(0,e.createElement)(v,null);case"users":return(0,e.createElement)(x,null);case"categories":return(0,e.createElement)(_,null);case"flights":return(0,e.createElement)(w,null);case"hotels":return(0,e.createElement)(N,null);case"roles":return(0,e.createElement)(C,null)}})()))))};document.addEventListener("DOMContentLoaded",()=>{const t=document.getElementById("umh-react-app-root");t?(0,a.render)((0,e.createElement)(M,null),t):console.error("Target div 'umh-react-app-root' not found.")})})();